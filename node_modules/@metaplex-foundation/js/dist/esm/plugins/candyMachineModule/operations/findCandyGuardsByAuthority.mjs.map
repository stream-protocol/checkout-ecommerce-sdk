{"version":3,"file":"findCandyGuardsByAuthority.mjs","sources":["../../../../../src/plugins/candyMachineModule/operations/findCandyGuardsByAuthority.ts"],"sourcesContent":["import { CandyGuard as MplCandyGuard } from '@metaplex-foundation/mpl-candy-guard';\nimport { PublicKey } from '@solana/web3.js';\nimport { CandyGuardsSettings, DefaultCandyGuardSettings } from '../guards';\nimport { CandyGuard, toCandyGuard } from '../models';\nimport { GpaBuilder } from '@/utils';\nimport { Operation, OperationHandler, OperationScope } from '@/types';\nimport { Metaplex } from '@/Metaplex';\n\n// -----------------\n// Operation\n// -----------------\n\nconst Key = 'FindCandyGuardsByAuthorityOperation' as const;\n\n/**\n * Find all Candy Guards matching by a given authority.\n *\n * ```ts\n * const candyGuards = await metaplex\n *   .candyMachines()\n *   .findAllCandyGuardsByAuthority({ authority: new PublicKey('...') });\n * ```\n *\n * @group Operations\n * @category Constructors\n */\nexport const findCandyGuardsByAuthorityOperation =\n  _findCandyGuardsByAuthorityOperation;\n// eslint-disable-next-line @typescript-eslint/naming-convention\nfunction _findCandyGuardsByAuthorityOperation<\n  T extends CandyGuardsSettings = DefaultCandyGuardSettings\n>(\n  input: FindCandyGuardsByAuthorityInput\n): FindCandyGuardsByAuthorityOperation<T> {\n  return { key: Key, input };\n}\n_findCandyGuardsByAuthorityOperation.key = Key;\n\n/**\n * @group Operations\n * @category Types\n */\nexport type FindCandyGuardsByAuthorityOperation<\n  T extends CandyGuardsSettings = DefaultCandyGuardSettings\n> = Operation<typeof Key, FindCandyGuardsByAuthorityInput, CandyGuard<T>[]>;\n\n/**\n * @group Operations\n * @category Inputs\n */\nexport type FindCandyGuardsByAuthorityInput = {\n  /** The authority to filter Candy Guards by. */\n  authority: PublicKey;\n};\n\n/**\n * @group Operations\n * @category Handlers\n */\nexport const findCandyGuardsByAuthorityOperationHandler: OperationHandler<FindCandyGuardsByAuthorityOperation> =\n  {\n    handle: async <T extends CandyGuardsSettings = DefaultCandyGuardSettings>(\n      operation: FindCandyGuardsByAuthorityOperation<T>,\n      metaplex: Metaplex,\n      scope: OperationScope\n    ) => {\n      const { authority } = operation.input;\n      const { programs, commitment } = scope;\n      const candyGuardProgram = metaplex.programs().getCandyGuard(programs);\n      const query = MplCandyGuard.gpaBuilder(\n        candyGuardProgram.address\n      ).addFilter('authority', authority);\n\n      const gpaBuilder = new GpaBuilder(metaplex, candyGuardProgram.address);\n      gpaBuilder.mergeConfig({ ...query.config, commitment });\n\n      return gpaBuilder.getAndMap((account) => toCandyGuard(account, metaplex));\n    },\n  };\n"],"names":["Key","findCandyGuardsByAuthorityOperation","_findCandyGuardsByAuthorityOperation","input","key","findCandyGuardsByAuthorityOperationHandler","handle","operation","metaplex","scope","authority","programs","commitment","candyGuardProgram","getCandyGuard","query","MplCandyGuard","gpaBuilder","address","addFilter","GpaBuilder","mergeConfig","config","getAndMap","account","toCandyGuard"],"mappings":";;;;AAQA;AACA;AACA;AAEA,MAAMA,GAAG,GAAG,qCAAZ,CAAA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AACaC,MAAAA,mCAAmC,GAC9CC;;AAEF,SAASA,oCAAT,CAGEC,KAHF,EAI0C;EACxC,OAAO;AAAEC,IAAAA,GAAG,EAAEJ,GAAP;AAAYG,IAAAA,KAAAA;GAAnB,CAAA;AACD,CAAA;;AACDD,oCAAoC,CAACE,GAArC,GAA2CJ,GAA3C,CAAA;AAEA;AACA;AACA;AACA;;AAcA;AACA;AACA;AACA;AACO,MAAMK,0CAAiG,GAC5G;AACEC,EAAAA,MAAM,EAAE,OACNC,SADM,EAENC,QAFM,EAGNC,KAHM,KAIH;IACH,MAAM;AAAEC,MAAAA,SAAAA;KAAcH,GAAAA,SAAS,CAACJ,KAAhC,CAAA;IACA,MAAM;MAAEQ,QAAF;AAAYC,MAAAA,UAAAA;AAAZ,KAAA,GAA2BH,KAAjC,CAAA;IACA,MAAMI,iBAAiB,GAAGL,QAAQ,CAACG,QAAT,EAAoBG,CAAAA,aAApB,CAAkCH,QAAlC,CAA1B,CAAA;AACA,IAAA,MAAMI,KAAK,GAAGC,UAAa,CAACC,UAAd,CACZJ,iBAAiB,CAACK,OADN,EAEZC,SAFY,CAEF,WAFE,EAEWT,SAFX,CAAd,CAAA;IAIA,MAAMO,UAAU,GAAG,IAAIG,UAAJ,CAAeZ,QAAf,EAAyBK,iBAAiB,CAACK,OAA3C,CAAnB,CAAA;AACAD,IAAAA,UAAU,CAACI,WAAX,CAAuB,EAAE,GAAGN,KAAK,CAACO,MAAX;AAAmBV,MAAAA,UAAAA;KAA1C,CAAA,CAAA;AAEA,IAAA,OAAOK,UAAU,CAACM,SAAX,CAAsBC,OAAD,IAAaC,YAAY,CAACD,OAAD,EAAUhB,QAAV,CAA9C,CAAP,CAAA;AACD,GAAA;AAjBH;;;;"}